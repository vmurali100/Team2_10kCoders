<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tasks edit</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="text" href="./index.html">
     
        <style>
             body{
                background: url(https://wallpaper-mania.com/wp-content/uploads/2018/09/High_resolution_wallpaper_background_ID_77700382606.jpg);
            }
             .table{
                border: 5px solid white;
                color: palegreen;
            }
               
            .form-label{
                color:rgb(112, 109, 109);
                font-size: 50px;
                align-self: center;
            }
            .btn{
                background-color: rgba(252, 41, 41, 0.774);
             
            }
            .btn:hover{
                background-color: rgba(252, 41, 41, 0);
                /* width: 200px; */
                /* height: 60px; */
                color: white;
            }
            .form-control{
                background-color: rgba(238, 238, 238, 0);
                font-size: 1.5em;
                color: wheat
            }
            .form-control:hover{
                border:5px red solid;
                background-color: rgb(255, 247, 247);
                height: 60px;
                color: black;

            }
        </style>
</head>
<body>
    <button type="button" onclick="getTasks()" class="btn btn-primary" id="gettask">Get Tasks</button>

    <script>
        var myArray ;
          document.getElementById("gettask").style.display ="block"
        function getTasks(){
            myArray = JSON.parse(localStorage.localData);
            viewTasks()
            document.getElementById("gettask").style.display = "none"
        }
        
        // var   myObject ={
        //    id : null,
        //    task : "",
        //    status : ""
        // }
        
      
        //
        function viewTasks() {
//    myArray = JSON.parse(localStorage.localData);

//    console.log(  myArray )
    // document.querySelector("tbody").innerHTML = "";
  myArray.forEach((myObject, i) => {
    
    
    var myTr = document.createElement("tr");
    var indexId = document.createElement("td");
    indexId.innerHTML = i + 1;
    myTr.appendChild(indexId);
    document.querySelector("tbody").appendChild(myTr);
    console.log("clicked");
    for (a in myObject) {
     if ( a!== "id"){
      var myTd = document.createElement("td");
      myTd.innerHTML = myObject[a];
      myTr.appendChild(myTd);
    }
     }

    // edit button
    var edited = document.createElement("td");
    var editBttn = document.createElement("button");
    editBttn.setAttribute("class", "btn");
    editBttn.setAttribute("onclick", "editElement(" + i + ")");
    myImg = document.createElement("img");
    myImg.setAttribute("src" , "./images/edit-removebg-preview.png");
    myImg.style.width = "50px"
    editBttn.style.background = "none"
    editBttn.appendChild(myImg)
    myTr.appendChild(edited);
    edited.appendChild(editBttn);

    //   delete button
    var deleted = document.createElement("td");
    var deleteBtn = document.createElement("button");
    deleteBtn.setAttribute("class", "btn");
    deleteBtn.setAttribute("onclick", "deleteElement(" + i + ")");
   
     myI = document.createElement("i");
     myI.setAttribute("class" , "fa fa-trash");
     myI.style.width = "px"
     deleteBtn.style.width= "50px"
     deleteBtn.style.height= "50px"
     deleteBtn.appendChild(myI)
    myTr.appendChild(deleted);
    deleted.appendChild(deleteBtn);

    document.querySelector("tbody").appendChild(myTr);
  });

} viewTasks()

var index;
function editElement(i) {
    myArray = JSON.parse(localStorage.localData);

  index = i;
  for (a in myArray[i]) {

    document.getElementById(a).value = myArray[i][a];
   

  }
  document.getElementById("form").style.display ="block"
  document.getElementById("table").style.display ="none"
}
function deleteElement(i) {
    document.querySelector("tbody").innerHTML = ""
  myArray.splice(i, 1);
  localStorage.setItem("localData", JSON.stringify(myArray));

    
       getTasks();
//   viewTasks(myArray);
}
function update(i) {
  // var employeeD = Object.assign({},employee);
  var myObject = {...myArray[index]};

  for (a in myObject) {
    myObject[a] = document.getElementById(a).value;
  }
  myArray[index] = { ...myObject};
  document.querySelector("tbody").innerHTML = ""
  viewTasks(myObject);
  localStorage.setItem("localData", JSON.stringify(myArray));

  document.getElementById("form").style.display = "none" ;
  document.getElementById("table").style.display = "block" ;
  // document.getElementById("submit").setAttribute('disabled' , true);
  // document.querySelector("button").setAttribute('disabled', true);
  clearForm();
}
function validate(){

  if(document.getElementById(a).innerHTML == " " ){
    document.getElementById("validate").setAttribute("disabled");
    document.getElementById("validate").setAttribute("disabled");

  }
}
    </script>
    <div class="container" style="margin-top: 30px; " id = "table">
        <div class="row">
         <div class="col-2"></div>
         <div class="col-8"><table class="table">
             <thead>
               <tr>
                 <th scope="col-">S.No</th>
                 <th scope="col" >TASK</th>
                 <th scope="col">STATUS</th>
                 <th scope="col" colspan="2">ACTION</th>
               </tr>
             </thead>
             <tbody>
              
             </tbody>
           </table></div>
           <div class="col-2"></div>
        </div>
    </div>
    <div class="container" style="margin-top: 100px; display: none;" id="form" >
        <div class="row">
            <div class="col-3"></div>
            <div class="col-6">
                <form style="">
                    <div class="mb-4">
                        <label for="id" class="form-label">ID</label>
                        <input type="number" class="form-control" id="id">
                    </div>
                    <div class="mb-4">
                        <label for="task" class="form-label">TASKS</label>
                        <input type="text" class="form-control" id="task" aria-describedby="emailHelp">
            
                    </div>
                    <div class="mb-4">
                        <label for="status" class="form-label">STATUS</label>
                        <input type="text" class="form-control" id="status">
                    </div>
                    <button type="button" class="btn btn-warning" onclick="update()" id="validate">UPDATE</button>
                    
                </form>
            
            </div>
            <div class="col-3"></div>
        </div>
    </div>
    <script src="./script.js"></script>
</body>
</html>